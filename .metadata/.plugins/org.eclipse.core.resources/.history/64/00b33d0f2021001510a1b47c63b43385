package curriculumdesign.cd2;

import java.io.IOException;
import java.io.PipedInputStream;
import java.io.PipedOutputStream;

class Sender1 extends Thread{
	private PipedOutputStream out = new PipedOutputStream();
	public PipedOutputStream getOut(){
		return out;
	}
	public void run(){
		String str = "hello pipe ! ";
		try {
			str = Thread.currentThread().getName()+str;
			out.write(str.getBytes());
		} catch (IOException e) {
			e.printStackTrace();
		}
	}
}
class Sender2 extends Thread{
	private PipedOutputStream out = new PipedOutputStream();
	public PipedOutputStream getOut(){
		return out;
	}
	public void run(){
		String str = "hello pipe ! ";
		try {
			str = Thread.currentThread().getName()+str;
			out.write(str.getBytes());
		} catch (IOException e) {
			e.printStackTrace();
		}
	}
}
class Reader extends Thread{
	private PipedInputStream in = new PipedInputStream();
	private byte[] bytes = new byte[1024];
	public PipedInputStream getIn(){
		return in;
	}
	public byte[] getBytes(){
		return bytes;
	}
	public void run(){
		try {
			in.read(bytes);
			System.out.println(new String(bytes));
		} catch (IOException e) {
			e.printStackTrace();
		}
	}
}
public class cd2test {

	public static void main(String[] args) {
		Sender1 send1 = new Sender1();
		Sender2 send2= new Sender2();
		Reader read = new Reader();
		PipedInputStream in = read.getIn();
		PipedOutputStream out1 = send1.getOut();
		PipedOutputStream out2 = send2.getOut();
		try {
			in.connect(out1);
			in.connect(out2);
		} catch (IOException e) {
			e.printStackTrace();
		}
		send1.start();
		send2.start();
		read.start();
	}

}
