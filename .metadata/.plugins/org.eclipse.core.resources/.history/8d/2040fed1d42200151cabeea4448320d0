package curriculumdesign.cd7;

import java.util.ArrayDeque;
import java.util.Vector;

public class PageRep {
	private int[] seqs;
	private int[] timefar;
	private int[] mem;
	private int[] timelong;
	public PageRep(int[] seqs, int memorysize){
		this.seqs = seqs;
		timefar = new int[memorysize];
		timelong = new int[memorysize];
		mem = new int[memorysize];
		for(int i = 0; i < timefar.length; i++){
			timefar[i] = 0;
			timelong[i] = 0;
		}
		for(int i = 0; i < memorysize; i++){
			mem[i] = -1;
		}
	}
	private boolean find(int num, int[] a){
		for(int i = 0; i < a.length; i++){
			if(a[i] == num){
				return true;
			}
		}
		return false;
	}
	private void showMem(){
		for(int i = 0; i < mem.length; i++){
			if(mem[i] != -1){
				System.out.print(mem[i] +" ");
			}
		}
		System.out.println();
	}
	public void FIFO(){
		int seat = 0;
		double sum = 0.0;
		for(int i = 0; i < seqs.length; i++){
			if(!find(seqs[i], mem)){
				mem[seat] = seqs[i];
				seat++;
				sum++;
				seat = seat % mem.length;
				showMem();
			}
		}
		System.out.printf("先进先出算法缺页率为 : %.2f",(sum / seqs.length));
	}
	private int findTimeLong(){
		int max = -1;
		int maxi = -1;
		for(int i = 0; i < timelong.length; i++){
			if(timelong[i] > max){
				max = timelong[i];
				maxi = i;
			}
		}
		return maxi;
	}
	public void LRU(){
		int seat = 0;
		double sum = 0;
		for(int i = 0; i <seqs.length; i++){
			if(!find(seqs[i],mem)){
				sum++;
				if(seat < mem.length){
					mem[seat] = seqs[i];
					seat++;
				}else{
					int j = findTimeLong();
					mem[j] = seqs[i];
					timelong[j] = 0;
					for(int k = 0; k < timelong.length; k++){
						if(k != j){
							timelong[k] ++;
						}
					}
				}
			}
			showMem();
		}
		System.out.printf("先进先出算法缺页率为 : %.2f",(sum / seqs.length));
	}
}
