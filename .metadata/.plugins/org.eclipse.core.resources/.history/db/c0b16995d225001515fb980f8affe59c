package Test2;

import java.util.Arrays;

public class ThreeSpline {
	private double[] x;
	private double[] y;
	private double[] h;
	private double[] u;
	private double[] r;
	private double[][] A;
	private double[] b;
	private double[][] dvtable;
	private double s1 = 1.0000;
	private double s5 = 0.6868;
	private ChaseMethod cm;
	public ThreeSpline(double[] xx, double[] yy){
		this.x = xx;
		this.y = yy;
		h = new double[x.length-1];
		u = new double[h.length];
		r = new double[h.length];
		A = new double[x.length][x.length];
		b = new double[x.length];
		dvtable = new double[3][x.length+2];
		for(int i = 0; i < h.length; i++){
			h[i] = x[i+1] - x[i];
		}
		for(int i = 1; i < u.length; i++){
			u[i-1] = h[i-1]/(h[i-1]+h[i]);
			r[i] = h[i]/(h[i-1]+h[i]);
		}
		u[u.length-1] = 1;
		r[0] = 1;
		for(int i = 0; i < x.length; i++ ){
			A[i][i] = 2;
		}
		for(int i = 0; i < x.length-1; i++){
			A[i][i+1] = r[i];
			A[i+1][i] = u[i];
		}
		dvtable[0][0] = y[0];
		dvtable[0][y.length+1] = y[y.length-1];
		
		for(int i = 0; i < y.length; i++){
			dvtable[0][i+1] = y[i];
		}
		dvtable[1][1] = s1;
		dvtable[1][y.length+1] = s5;
		for(int i = 2; i < y.length+1; i++){
			dvtable[1][i] = (dvtable[0][i]-dvtable[0][i-1])/(x[i-1]-x[i-2]);
		}
		dvtable[2][2] = (dvtable[1][2]-dvtable[1][1])/(x[1]-x[0]);
		dvtable[2][3] = (dvtable[1][3]-dvtable[1][2])/(x[2]-x[0]);
		dvtable[2][4] = (dvtable[1][4]-dvtable[1][3])/(x[3]-x[1]);
		dvtable[2][5] = (dvtable[1][5]-dvtable[1][4])/(x[4]-x[2]);
		dvtable[2][6] = (dvtable[1][6]-dvtable[1][5])/(x[4]-x[3]);
		
		for(int i = 0; i < b.length; i++){
			b[i] = dvtable[2][i+2];
		}
		cm = new ChaseMethod(A, b, 5);
//		System.out.println(Arrays.toString(u)+" ----- "+Arrays.toString(r));
//		System.out.println("------------------------------------------------------------------");
//		for(int i = 0; i < A.length; i++){
//			for(int j = 0; j < A[0].length; j++){
//				System.out.print(A[i][j]+" ");
//			}
//			System.out.println();
//		}
//		System.out.println("------------------------------------------------------------------");
//		for(int i = 0; i < dvtable.length; i++){
//			for(int j = 0; j < dvtable[0].length; j++){
//				System.out.print(dvtable[i][j]+" ");
//			}
//			System.out.println();
//		}
//		System.out.println("------------------------------------------------------------------");
		System.out.println(Arrays.toString(cm.getX()));
	}
}	
